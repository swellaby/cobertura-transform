trigger:
- master

pr:
- master

pool:
  vmImage: 'Ubuntu-16.04'

steps:
- script: npm i
  displayName: 'Install dependencies'

- script: npm run build
  displayName: 'Run npm build script'

- task: PublishTestResults@2
  inputs:
    testRunner: JUnit
    testResultsFiles: .testresults/unit/xunit.xml
    testRunTitle: cobertura-transform PR Linux $(Build.BuildId)

- task: PublishCodeCoverageResults@1
  inputs:
    codeCoverageTool: 'Cobertura'
    summaryFileLocation: $(Build.SourcesDirectory)/.coverage/unit/cobertura-coverage.xml
    reportDirectory: $(Build.SourcesDirectory)/.coverage/unit
    failIfCoverageEmpty: true
  displayName: 'Publish coverage results'
